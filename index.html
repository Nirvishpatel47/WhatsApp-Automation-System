<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="Referrer-Policy" content="no-referrer">
    <title>Business Management Portal</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <header class="app-header">
        Crevoxega
    </header>
    
    <div class="overlay" id="overlay" onclick="closeSidebar()"></div>

    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h3>App</h3>
            <button class="close-sidebar" onclick="closeSidebar()">‚úï</button>
        </div>
        <div class="sidebar-menu">
            <button class="menu-item" onclick="showSection('dashboard')">
                <span class="menu-icon">üìä</span>
                <span>Customers and Non-members</span>
            </button>
            <button class="menu-item" onclick="showSection('customers')">
                <span class="menu-icon">üë•</span>
                <span>Dashboard</span>
            </button>
            <button class="menu-item" onclick="showSection('support')">
                <span class="menu-icon">üí¨</span>
                <span>Customer Support</span>
            </button>
            <button class="menu-item" onclick="showSection('documents')">
                <span class="menu-icon">üìÑ</span>
                <span>Documents</span>
            </button>
            <button class="menu-item restaurant-only" onclick="showSection('orders')">
                <span class="menu-icon">üçΩÔ∏è</span>
                <span>Pending Orders</span>
            </button>
            <button class="menu-item restaurant-only" onclick="showSection('confirmedOrders')">
                <span class="menu-icon">‚úÖ</span>
                <span>Confirmed Orders</span>
            </button>
            <div style="border-top: 1px solid var(--border); margin: 12px 0;"></div>
            <button class="menu-item" onclick="logout()">
                <span class="menu-icon">üö™</span>
                <span>Logout</span>
            </button>
            <button class="menu-item" onclick="showSection('payment')">
                <span class="menu-icon">üí≥</span>
                <span>Upgrade</span>
            </button>
        </div>
    </div>

    <div class="modal" id="privacyModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Privacy Policy</h2>
                <button class="close-modal" onclick="closePrivacyModal()">‚úï</button>
            </div>
            <div style="color: var(--text-light); line-height: 1.8;">
                <p style="margin-bottom: 16px;"><strong>Effective Date:</strong> October 2025</p>
                
                <h3 style="color: var(--primary); margin-top: 20px;">1. Information We Collect</h3>
                <p>We collect business information including business name, owner details, contact information, and uploaded documents necessary for service provision.</p>
                
                <h3 style="color: var(--primary); margin-top: 20px;">2. How We Use Your Information</h3>
                <p>Your information is used to provide business management services, customer communication, and platform functionality. We never sell your data to third parties.</p>
                
                <h3 style="color: var(--primary); margin-top: 20px;">3. Data Security</h3>
                <p>We implement industry-standard encryption and security measures to protect your data. All sensitive information is encrypted both in transit and at rest.</p>
                
                <h3 style="color: var(--primary); margin-top: 20px;">4. Your Rights</h3>
                <p>You have the right to access, modify, or delete your data at any time. Contact our support team for data requests.</p>
                
                <h3 style="color: var(--primary); margin-top: 20px;">5. Contact Us</h3>
                <p>For privacy concerns, contact us through the Customer Support section.</p>
                
                <div style="margin-top: 24px;">
                    <a href="privacy_policy.pdf" target="_blank" style="color: var(--primary); text-decoration: underline;">Download Full Privacy Policy (PDF)</a>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div id="loginPage">
            <div class="card" style="max-width: 450px; margin: 80px auto;">
                <div class="header">
                    <h1>Login</h1>
                    <p>Access to your dashboard</p>
                </div>

                <div id="loginAlert" class="alert"></div>

                <form id="loginForm">
                    <div class="form-group">
                        <label>Email Address</label>
                        <input type="email" id="loginEmail" placeholder="your@email.com" required autocomplete="email">
                    </div>

                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="current-password">
                    </div>

                    <button type="submit" class="btn btn-primary">Login</button>
                    <button type="button" class="btn btn-secondary" onclick="showRegister()">
                        New Business? Register Here
                    </button>
                </form>
            </div>
        </div>

    <div id="registerPage" class="hidden">
        <div class="card" style="width: 90%; max-width: 1200px; margin: 40px auto;"> 
            <div class="header">
                <h1>Business Registration</h1>
                <p style="color: var(--primary);">Start your journey with Crevoxega today.</p>
            </div>

            <div id="registerAlert" class="alert"></div>

            <form id="registerForm">
                <div class="section-title">üè¢ General Business Details</div>
                <div class="row row-2">
                    <div class="form-group">
                        <label>Business Name *</label>
                        <input type="text" id="businessName" placeholder="e.g., The Fusion Kitchen" required maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>Business Owner Name *</label>
                        <input type="text" id="ownerName" placeholder="Full Name" required maxlength="100">
                    </div>
                </div>

                <div class="form-group">
                    <label for="businessTypeSelect">Business Type *</label>
                    <select id="businessTypeSelect" name="businessType" class="form-select" required>
                        <option value="" selected disabled>Select Business Type</option>
                        <option value="Restaurant">Restaurant</option>
                        <option value="Bakery">Bakery</option>
                        <option value="Gym">GYM</option>
                        <option value="General">GENERAL</option>
                    </select>
                </div>

                <div class="divider"></div>

                <div class="section-title">üîí Contact and Security</div>
                <div class="row row-2">
                    <div class="form-group">
                        <label>Email Address *</label>
                        <input type="email" id="email" placeholder="business@email.com" required maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>Phone Number *</label>
                        <input type="tel" id="phone" placeholder="+91XXXXXXXXXX" required maxlength="15">
                    </div>
                </div>
                <div class="row row-2">
                    <div class="form-group">
                        <label>Password *</label>
                        <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required minlength="8" maxlength="128" autocomplete="new-password">
                    </div>
                    <div class="form-group">
                        <label>Account Verification Token (Optional)</label>
                        <input type="text" id="verifyToken" placeholder="Enter token if provided" maxlength="256">
                    </div>
                </div>

                <div class="divider"></div>

                <div class="section-title">üí¨ WhatsApp Integration (Optional)</div>
                <p style="color: var(--secondary); font-size: 0.9rem; margin-bottom: 15px;">Enable seamless order and customer communication.</p>
                <div class="row row-2">
                    <div class="form-group">
                        <label>WhatsApp Phone ID</label>
                        <input type="text" id="waPhoneId" placeholder="e.g., 10034567890123" maxlength="128">
                    </div>
                    <div class="form-group">
                        <label>WhatsApp Verification Token</label>
                        <input type="text" id="waVerifyToken" placeholder="Enter meta verification token" maxlength="256">
                    </div>
                </div>

                <div class="divider"></div>

                <div class="section-title">üìÑ Required Documents</div>
                <div class="file-upload" onclick="document.getElementById('fileInput').click()">
                    <div id="fileLabel">Click to upload document (PDF, TXT - Max 10MB)</div>
                    <input type="file" id="fileInput" accept=".pdf,.txt" onchange="handleFileSelect(event)">
                </div>

                <div class="divider"></div>

                <div class="checkbox-container">
                    <input type="checkbox" id="privacyCheckbox" required>
                    <label for="privacyCheckbox">
                        I agree to the <a href="#" onclick="showPrivacyPolicy(event)">Privacy Policy</a> *
                    </label>
                </div>

                <button type="submit" class="btn btn-primary" id="registerBtn" style="margin-top: 20px;">
                    Complete Registration
                </button>
                <button type="button" class="btn btn-secondary" onclick="showLogin()" style="margin-top: 10px;">
                    Back to Login
                </button>
            </form>
        </div>
    </div>

        <div id="dashboardPage" class="hidden">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <button class="hamburger" onclick="toggleSidebar()">‚ò∞</button>
                <button class="btn btn-secondary" onclick="logout()" style="width: auto; padding: 8px 16px; margin: 0;">
                    Logout
                </button>
            </div>

            <div id="dashboardAlert" class="alert"></div>

            <div id="dashboardSection">
                <div class="card">
                    <div class="section-title">Add New Customer</div>
                    <form id="addCustomerForm">
                        <div class="row row-3">
                            <div class="form-group">
                                <label>Customer Name *</label>
                                <input type="text" id="customerName" required maxlength="100">
                            </div>
                            <div class="form-group">
                                <label>Phone Number *</label>
                                <input type="tel" id="customerPhone" required maxlength="15">
                            </div>
                            <div class="form-group">
                                <label>Plan End Date *</label>
                                <input type="date" id="customerPlanEnd" required>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Add Customer</button>
                    </form>
                </div>

                <div class="card">
                    <div class="section-title">Add Non-Member</div>
                    <form id="addNonMemberForm">
                        <div class="row row-2">
                            <div class="form-group">
                                <label>Name *</label>
                                <input type="text" id="nonMemberName" required maxlength="100">
                            </div>
                            <div class="form-group">
                                <label>Phone Number *</label>
                                <input type="tel" id="nonMemberPhone" required maxlength="15">
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Add Non-Member</button>
                    </form>
                </div>

                <div class="card" id="customersCard" style="display: none;">
                    <div class="section-title">Customers Added This Session</div>
                    <table class="table" id="customersTable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Phone</th>
                                <th>Plan End Date</th>
                            </tr>
                        </thead>
                        <tbody id="customersTableBody"></tbody>
                    </table>
                    <button class="btn btn-secondary" onclick="clearSessionList()">Clear Session List</button>
                </div>
            </div>

            <div id="supportSection" class="hidden">
                <div class="card">
                    <div class="section-title">Customer Support</div>
                    <p style="color: var(--secondary); margin-bottom: 20px;">Need help? Contact our support team.</p>
                    
                    <div class="form-group">
                        <label>Subject</label>
                        <input type="text" id="supportSubject" placeholder="Brief description of your issue" maxlength="200">
                    </div>
                    
                    <div class="form-group">
                        <label>Message</label>
                        <textarea id="supportMessage" rows="6" placeholder="Describe your issue in detail..." maxlength="2000"></textarea>
                    </div>
                    
                    <button class="btn btn-primary" onclick="submitSupport()">Submit Support Request</button>
                    
                    <div style="margin-top: 24px; padding: 16px; background: var(--bg-light); border-radius: 8px; border: 1px solid var(--border);">
                        <h4 style="color: var(--primary); margin-bottom: 8px;">Alternative Contact</h4>
                        <p style="color: var(--text-light);">Email: Crevoxega@gmail.com</p>
                        <p style="color: var(--text-light);">Response Time: Within 24 hours</p>
                    </div>
                </div>
            </div>

            <div id="documentsSection" class="hidden">
                <div class="card">
                    <div class="section-title">Upload New Document</div>
                    <form id="uploadDocumentForm">
                        <div class="form-group">
                            <label>Document Name</label>
                            <input type="text" id="documentName" placeholder="e.g., Product Catalog" maxlength="100">
                        </div>
                        
                        <div class="file-upload" onclick="document.getElementById('newDocInput').click()">
                            <div id="newDocLabel">Click to upload document (PDF, TXT - Max 1MB)</div>
                            <input type="file" id="newDocInput" accept=".pdf,.txt" onchange="handleNewDocSelect(event)">
                        </div>
                        
                        <button type="submit" class="btn btn-primary">Upload Document</button>
                    </form>
                </div>

                <div class="card">
                    <div class="section-title">Your Documents</div>
                    <p style="color: var(--secondary);">Manage your uploaded documents here.</p>
                    <div id="documentsList" style="margin-top: 16px;">
                        <p style="color: var(--secondary);">No documents uploaded yet.</p>
                    </div>
                </div>
            </div>
        </div>
        

            <div id="customersSection" class="hidden">
                <div class="card">
                    <div class="section-title">Customer List</div>
                    <p style="color: var(--secondary);">View and manage your customers.</p>
                    <div style="margin-top: 16px;">
                        <p style="color: var(--secondary);">Customer management features coming soon...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="paymentSection" class="hidden">
        <div class="card">
            <div class="section-title">Payment Link Management</div>
            <p style="color: var(--secondary); margin-bottom: 20px;">Set up your payment link for customer upgrades and renewals.</p>
            
            <form id="paymentLinkForm">
                <div class="form-group">
                    <label>Payment Link URL *</label>
                    <input type="url" id="paymentLinkUrl" placeholder="https://your-payment-gateway.com/pay" required maxlength="500">
                    <p style="color: var(--secondary); font-size: 0.85rem; margin-top: 4px;">
                        Enter your payment gateway link (e.g., Razorpay, PayPal, Stripe, PhonePay, UPI)
                    </p>
                </div>
                
                <div class="form-group">
                    <label>Link Description (Optional)</label>
                    <input type="text" id="paymentLinkDesc" placeholder="e.g., Monthly Membership Payment" maxlength="200">
                </div>
                
                <button type="submit" class="btn btn-primary">Save Payment Link</button>
            </form>
            
            <div style="margin-top: 24px; padding: 16px; background: var(--bg-light); border-radius: 8px; border: 1px solid var(--border);" id="currentPaymentLink">
                <h4 style="color: var(--primary); margin-bottom: 8px;">Current Payment Link</h4>
                <p style="color: var(--text-light); word-break: break-all;" id="displayPaymentLink">Not set yet</p>
                <p style="color: var(--secondary); font-size: 0.85rem; margin-top: 4px;" id="displayPaymentDesc"></p>
            </div>
        </div>
    </div>
    <div id="ordersSection" class="hidden">
        <div class="card">
            <div class="section-title">üìã Pending Orders</div>
            <div id="pendingOrdersContainer" class="orders-grid">
                </div>
        </div>
    </div>

    <div id="confirmedOrdersSection" class="hidden">
        <div class="card">
            <div class="section-title">‚úÖ Confirmed Orders</div>
            <div id="confirmedOrdersContainer" class="orders-grid">
                </div>
        </div>
    </div>

    <footer class="app-footer">
        &copy; 2025 Crevoxega - All rights reserved.
    </footer>

    <script src="/static/script.js"> </script>
</body>
</html>